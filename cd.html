<style>
    html, body {
      margin: 0;
      width: 100%;
      height: 100%;
      background: #000;
      overflow: hidden;
    }
  
    #cdModelContainer {
      position: relative;
      width: 100vw;
      height: 100vh;
      background: #000;
    }
  
    /* Canvas behind the button */
    #cdModelContainer canvas {
      position: absolute;
      inset: 0;
      z-index: 1;
    }
  
    /* Click layer above canvas */
    #cdInteractionButton {
      position: absolute;
      left: 50%;
      top: 50%;
      transform: translate(-50%, -50%);
      width: 45vmin;
      height: 45vmin;
      background: rgba(255, 0, 0, 0); /* transparent */
      border: none;
      cursor: pointer;
      z-index: 10;
      pointer-events: auto;
    }
  </style>
  
  <body>
    <div id="cdModelContainer">
      <button id="cdInteractionButton" aria-label="Play CD"></button>
    </div>
  
    <script src="https://cdn.jsdelivr.net/npm/three@0.140.0/build/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.140.0/examples/js/loaders/GLTFLoader.js"></script>
  
    <script>
      // --------------------
      // BASIC SETUP
      // --------------------
      const container = document.getElementById('cdModelContainer');
      const btn = document.getElementById('cdInteractionButton');
  
      const scene = new THREE.Scene();
      const camera = new THREE.PerspectiveCamera(
        75,
        window.innerWidth / window.innerHeight,
        0.1,
        1000
      );
  
      const renderer = new THREE.WebGLRenderer({ antialias: true, alpha: false });
      renderer.setPixelRatio(Math.min(window.devicePixelRatio || 1, 2));
      renderer.setSize(window.innerWidth, window.innerHeight);
  
      // force black clear color
      renderer.setClearColor(0x000000, 1);
  
      container.appendChild(renderer.domElement);
  
      camera.position.z = 50;
  
      // --------------------
      // LIGHTING
      // --------------------
      scene.add(new THREE.AmbientLight(0x404040, 4));
  
      const pointLight = new THREE.PointLight(0xffffff, 1, 100);
      pointLight.position.set(10, 10, 10);
      scene.add(pointLight);
  
      // --------------------
      // LOAD SINGLE MODEL
      // --------------------
      const loader = new THREE.GLTFLoader();
      let cdMesh = null;
  
      loader.load(
        'media/CD2.glb',
        (gltf) => {
          cdMesh = gltf.scene;
          scene.add(cdMesh);
  
          cdMesh.scale.set(15, 15, 15);
          cdMesh.rotation.x = Math.PI / 3;
          cdMesh.rotation.y = (Math.PI / 5) * (-3.75);
  
          animate();
        },
        undefined,
        (err) => console.error('FAILED TO LOAD media/CD2.glb', err)
      );
  
      // --------------------
      // AUDIO (RANDOM SONGS)
      // --------------------
      const songs = [
        'audio/bloodgnats.mp3',
        'audio/walkdown.mp3',
        'audio/orochimaru.mp3',
        'audio/the rapture.mp3',
        'audio/Trapstar.mp3',
        'audio/I_Know.mp3',
        'audio/GOBLINREAL.mp3',
        'audio/foresight.mp3',
        'audio/tranquility.mp3',
        'audio/quasar.mp3'
      ];
  
      const audio = new Audio();
  
      function playRandomSong() {
        const index = Math.floor(Math.random() * songs.length);
        audio.src = songs[index];
        audio.play().catch(() => {
          // mobile requires user gesture; click provides it
        });
      }
  
      // --------------------
      // INTERACTION + SPIN
      // --------------------
      let isClicked = false;
      let isTransitionComplete = false;
  
      const spinSpeed = 0.015;
      const clickSpinSpeed = 0.4;
      let currentSpinSpeed = spinSpeed;
  
      let targetXRotation = Math.PI / 3;
      let targetYRotation = (Math.PI / 5) * (-3.75);
      let targetZRotation = 0;
  
      function animate() {
        requestAnimationFrame(animate);
        if (!cdMesh) return;
  
        if (isClicked) {
          if (!isTransitionComplete) {
            const dx = (targetXRotation - cdMesh.rotation.x) * 0.1;
            const dy = (targetYRotation - cdMesh.rotation.y) * 0.1;
            const dz = (targetZRotation - cdMesh.rotation.z) * 0.1;
  
            cdMesh.rotation.x += dx;
            cdMesh.rotation.y += dy;
            cdMesh.rotation.z += dz;
  
            if (Math.abs(dx) < 0.01 && Math.abs(dy) < 0.01 && Math.abs(dz) < 0.01) {
              isTransitionComplete = true;
              currentSpinSpeed = clickSpinSpeed;
            }
          } else {
            cdMesh.rotation.y += currentSpinSpeed;
            cdMesh.rotation.z = 0;
          }
        } else {
          cdMesh.rotation.z += currentSpinSpeed;
          isTransitionComplete = false;
        }
  
        renderer.render(scene, camera);
      }
  
      // --------------------
      // CLICK HANDLER
      // --------------------
      btn.addEventListener('click', () => {
        isClicked = !isClicked;
  
        if (isClicked) {
          targetXRotation = 0.35;
          targetYRotation = (Math.PI / 5) * (-2.75);
          targetZRotation = 0;
          playRandomSong();
        } else {
          targetXRotation = Math.PI / 3;
          targetYRotation = (Math.PI / 5) * (-2.75);
          targetZRotation = 0;
          currentSpinSpeed = spinSpeed;
          audio.pause();
          audio.currentTime = 0;
        }
      });
  
      // --------------------
      // RESIZE
      // --------------------
      window.addEventListener('resize', () => {
        camera.aspect = window.innerWidth / window.innerHeight;
        camera.updateProjectionMatrix();
        renderer.setSize(window.innerWidth, window.innerHeight);
      });
    </script>
  </body>
  
